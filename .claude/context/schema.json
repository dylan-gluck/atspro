{
  "$schema": "http://json-schema.org/draft-07/schema#",
  "title": "Claude Agent Context System",
  "type": "object",
  "definitions": {
    "agentContext": {
      "type": "object",
      "properties": {
        "id": { "type": "string" },
        "type": { "type": "string", "enum": ["fullstack-eng", "doc-expert", "code-review", "e2e-tester", "frontend-eng", "ux-eng", "log-monitor"] },
        "status": { "type": "string", "enum": ["pending", "running", "completed", "failed"] },
        "startTime": { "type": "string", "format": "date-time" },
        "endTime": { "type": "string", "format": "date-time" },
        "task": { "type": "string" },
        "results": {
          "type": "object",
          "properties": {
            "summary": { "type": "string" },
            "files": { "type": "array", "items": { "type": "string" } },
            "findings": { "type": "array", "items": { "$ref": "#/definitions/finding" } },
            "recommendations": { "type": "array", "items": { "type": "string" } },
            "metadata": { "type": "object" }
          }
        },
        "context": {
          "type": "object",
          "properties": {
            "workflow": { "type": "string" },
            "dependencies": { "type": "array", "items": { "type": "string" } },
            "sharedData": { "type": "object" }
          }
        }
      },
      "required": ["id", "type", "status", "task"]
    },
    "finding": {
      "type": "object",
      "properties": {
        "type": { "type": "string", "enum": ["bug", "improvement", "security", "performance", "documentation"] },
        "severity": { "type": "string", "enum": ["low", "medium", "high", "critical"] },
        "file": { "type": "string" },
        "line": { "type": "integer" },
        "description": { "type": "string" },
        "suggestion": { "type": "string" }
      },
      "required": ["type", "severity", "description"]
    },
    "workflowState": {
      "type": "object",
      "properties": {
        "id": { "type": "string" },
        "name": { "type": "string" },
        "status": { "type": "string", "enum": ["pending", "running", "completed", "failed"] },
        "currentStep": { "type": "integer" },
        "totalSteps": { "type": "integer" },
        "agents": { "type": "array", "items": { "$ref": "#/definitions/agentContext" } },
        "sharedContext": { "type": "object" },
        "metadata": {
          "type": "object",
          "properties": {
            "startTime": { "type": "string", "format": "date-time" },
            "estimatedDuration": { "type": "integer" },
            "priority": { "type": "string", "enum": ["low", "medium", "high"] }
          }
        }
      },
      "required": ["id", "name", "status"]
    },
    "sessionContext": {
      "type": "object",
      "properties": {
        "sessionId": { "type": "string" },
        "startTime": { "type": "string", "format": "date-time" },
        "activeWorkflows": { "type": "array", "items": { "type": "string" } },
        "completedWorkflows": { "type": "array", "items": { "type": "string" } },
        "globalContext": { "type": "object" },
        "metrics": {
          "type": "object",
          "properties": {
            "totalAgents": { "type": "integer" },
            "completedTasks": { "type": "integer" },
            "codeChanges": { "type": "integer" },
            "testsRun": { "type": "integer" }
          }
        }
      },
      "required": ["sessionId", "startTime"]
    }
  },
  "properties": {
    "session": { "$ref": "#/definitions/sessionContext" },
    "workflows": { 
      "type": "array", 
      "items": { "$ref": "#/definitions/workflowState" }
    },
    "agents": {
      "type": "array",
      "items": { "$ref": "#/definitions/agentContext" }
    }
  },
  "required": ["session"]
}